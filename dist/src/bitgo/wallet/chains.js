"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isSegwit = exports.isInternalChainCode = exports.isExternalChainCode = exports.getInternalChainCode = exports.getExternalChainCode = exports.scriptTypeForChain = exports.toChainPair = exports.isChainCode = exports.chainCodes = exports.chainCodesP2trMusig2 = exports.chainCodesP2tr = exports.chainCodesP2wsh = exports.chainCodesP2shP2wsh = exports.chainCodesP2sh = void 0;
/**
 * All valid chain codes
 */
exports.chainCodesP2sh = [0, 1];
exports.chainCodesP2shP2wsh = [10, 11];
exports.chainCodesP2wsh = [20, 21];
exports.chainCodesP2tr = [30, 31];
exports.chainCodesP2trMusig2 = [40, 41];
exports.chainCodes = [
    ...exports.chainCodesP2sh,
    ...exports.chainCodesP2shP2wsh,
    ...exports.chainCodesP2wsh,
    ...exports.chainCodesP2tr,
    ...exports.chainCodesP2trMusig2,
];
function isChainCode(n) {
    return exports.chainCodes.includes(n);
}
exports.isChainCode = isChainCode;
const map = new Map([
    ['p2sh', exports.chainCodesP2sh],
    ['p2shP2wsh', exports.chainCodesP2shP2wsh],
    ['p2wsh', exports.chainCodesP2wsh],
    ['p2tr', exports.chainCodesP2tr],
    ['p2trMusig2', exports.chainCodesP2trMusig2],
].map(([k, v]) => [k, Object.freeze(v)]));
const pairs = [...map.values()];
/**
 * @return ChainCodePair for input
 */
function toChainPair(v) {
    let pair;
    if (Array.isArray(v)) {
        if (pairs.includes(v)) {
            pair = v;
        }
    }
    if (typeof v === 'string') {
        pair = map.get(v);
    }
    if (typeof v === 'number') {
        pair = pairs.find((p) => p.includes(v));
    }
    if (!pair) {
        throw new Error(`no pair for input ${v}`);
    }
    return pair;
}
exports.toChainPair = toChainPair;
/**
 * @return ScriptType2Of3 for input
 */
function scriptTypeForChain(chain) {
    for (const [scriptType, pair] of map.entries()) {
        if (pair.includes(chain)) {
            return scriptType;
        }
    }
    throw new Error(`invalid chain ${chain}`);
}
exports.scriptTypeForChain = scriptTypeForChain;
/**
 * @return chain code intended for external addresses
 */
function getExternalChainCode(v) {
    return toChainPair(v)[0];
}
exports.getExternalChainCode = getExternalChainCode;
/**
 * @return chain code intended for change outputs
 */
function getInternalChainCode(v) {
    return toChainPair(v)[1];
}
exports.getInternalChainCode = getInternalChainCode;
/**
 * @return true iff chain code is external
 */
function isExternalChainCode(v) {
    return toChainPair(v).indexOf(v) === 0;
}
exports.isExternalChainCode = isExternalChainCode;
/**
 * @return true iff chain code is internal
 */
function isInternalChainCode(v) {
    return toChainPair(v).indexOf(v) === 1;
}
exports.isInternalChainCode = isInternalChainCode;
/**
 * @return true iff chain code is a segwit address
 */
function isSegwit(v) {
    const segwitCodes = [
        ...exports.chainCodesP2shP2wsh,
        ...exports.chainCodesP2wsh,
        ...exports.chainCodesP2tr,
        ...exports.chainCodesP2trMusig2,
    ];
    return segwitCodes.includes(v);
}
exports.isSegwit = isSegwit;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhaW5zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2JpdGdvL3dhbGxldC9jaGFpbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBYUE7O0dBRUc7QUFDVSxRQUFBLGNBQWMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQVUsQ0FBQztBQUNqQyxRQUFBLG1CQUFtQixHQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBVSxDQUFDO0FBQ3hDLFFBQUEsZUFBZSxHQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBVSxDQUFDO0FBQ3BDLFFBQUEsY0FBYyxHQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBVSxDQUFDO0FBQ25DLFFBQUEsb0JBQW9CLEdBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFVLENBQUM7QUFDekMsUUFBQSxVQUFVLEdBQUc7SUFDeEIsR0FBRyxzQkFBYztJQUNqQixHQUFHLDJCQUFtQjtJQUN0QixHQUFHLHVCQUFlO0lBQ2xCLEdBQUcsc0JBQWM7SUFDakIsR0FBRyw0QkFBb0I7Q0FDeEIsQ0FBQztBQUVGLFNBQWdCLFdBQVcsQ0FBQyxDQUFVO0lBQ3BDLE9BQU8sa0JBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBYyxDQUFDLENBQUM7QUFDN0MsQ0FBQztBQUZELGtDQUVDO0FBUUQsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQ2pCO0lBQ0UsQ0FBQyxNQUFNLEVBQUUsc0JBQWMsQ0FBQztJQUN4QixDQUFDLFdBQVcsRUFBRSwyQkFBbUIsQ0FBQztJQUNsQyxDQUFDLE9BQU8sRUFBRSx1QkFBZSxDQUFDO0lBQzFCLENBQUMsTUFBTSxFQUFFLHNCQUFjLENBQUM7SUFDeEIsQ0FBQyxZQUFZLEVBQUUsNEJBQW9CLENBQUM7Q0FDckMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFtQixFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFrQixDQUFDLENBQUMsQ0FDNUUsQ0FBQztBQUVGLE1BQU0sS0FBSyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztBQUVoQzs7R0FFRztBQUNILFNBQWdCLFdBQVcsQ0FBQyxDQUE2QztJQUN2RSxJQUFJLElBQUksQ0FBQztJQUNULElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRTtRQUNwQixJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBa0IsQ0FBQyxFQUFFO1lBQ3RDLElBQUksR0FBRyxDQUFDLENBQUM7U0FDVjtLQUNGO0lBQ0QsSUFBSSxPQUFPLENBQUMsS0FBSyxRQUFRLEVBQUU7UUFDekIsSUFBSSxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDbkI7SUFDRCxJQUFJLE9BQU8sQ0FBQyxLQUFLLFFBQVEsRUFBRTtRQUN6QixJQUFJLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3pDO0lBQ0QsSUFBSSxDQUFDLElBQUksRUFBRTtRQUNULE1BQU0sSUFBSSxLQUFLLENBQUMscUJBQXFCLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDM0M7SUFDRCxPQUFPLElBQXFCLENBQUM7QUFDL0IsQ0FBQztBQWpCRCxrQ0FpQkM7QUFFRDs7R0FFRztBQUNILFNBQWdCLGtCQUFrQixDQUFDLEtBQWdCO0lBQ2pELEtBQUssTUFBTSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsT0FBTyxFQUFFLEVBQUU7UUFDOUMsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFO1lBQ3hCLE9BQU8sVUFBVSxDQUFDO1NBQ25CO0tBQ0Y7SUFDRCxNQUFNLElBQUksS0FBSyxDQUFDLGlCQUFpQixLQUFLLEVBQUUsQ0FBQyxDQUFDO0FBQzVDLENBQUM7QUFQRCxnREFPQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0Isb0JBQW9CLENBQUMsQ0FBNkM7SUFDaEYsT0FBTyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDM0IsQ0FBQztBQUZELG9EQUVDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixvQkFBb0IsQ0FBQyxDQUE2QztJQUNoRixPQUFPLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMzQixDQUFDO0FBRkQsb0RBRUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLG1CQUFtQixDQUFDLENBQVk7SUFDOUMsT0FBTyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN6QyxDQUFDO0FBRkQsa0RBRUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLG1CQUFtQixDQUFDLENBQVk7SUFDOUMsT0FBTyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN6QyxDQUFDO0FBRkQsa0RBRUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLFFBQVEsQ0FBQyxDQUFZO0lBQ25DLE1BQU0sV0FBVyxHQUFnQjtRQUMvQixHQUFHLDJCQUFtQjtRQUN0QixHQUFHLHVCQUFlO1FBQ2xCLEdBQUcsc0JBQWM7UUFDakIsR0FBRyw0QkFBb0I7S0FDeEIsQ0FBQztJQUNGLE9BQU8sV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNqQyxDQUFDO0FBUkQsNEJBUUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogRGVmaW5lcyBCaXRHbyBtYXBwaW5ncyBiZXR3ZWVuIGJpcDMyIGRlcml2YXRpb24gcGF0aCBhbmQgc2NyaXB0IHR5cGUuXHJcbiAqXHJcbiAqIFRoZSBzY3JpcHRzIGZvciBhIEJpdEdvIHdhbGxldCBhZGRyZXNzIGFyZSBkZWZpbmVkIGJ5IHRoZWlyIGRlcml2YXRpb24gcGF0aC5cclxuICpcclxuICogVGhlIGRlcml2YXRpb24gcGF0aCBoYXMgdGhlIGZvcm1hdCBgMC8wLyR7Y2hhaW59LyR7aW5kZXh9YCAoaW4gcmFyZSBjYXNlcyB0aGUgcHJlZml4IGlzIG5vdCAwLzApXHJcbiAqXHJcbiAqIFRoZSBhZGRyZXNzIHNjcmlwdCB0eXBlIChTY3JpcHRUeXBlMk9mMykgaXMgZGVmaW5lZCBieSB0aGUgYGNoYWluYCBwYXJhbWV0ZXIuXHJcbiAqXHJcbiAqIFRoaXMgZmlsZSBkZWZpbmVzIHRoZSBtYXBwaW5nIGJldHdlZW4gY2hhaW4gcGFyYW1ldGVyIGFuZCBhZGRyZXNzIHR5cGUuXHJcbiAqL1xyXG5pbXBvcnQgeyBTY3JpcHRUeXBlMk9mMyB9IGZyb20gJy4uL291dHB1dFNjcmlwdHMnO1xyXG5cclxuLyoqXHJcbiAqIEFsbCB2YWxpZCBjaGFpbiBjb2Rlc1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGNoYWluQ29kZXNQMnNoID0gWzAsIDFdIGFzIGNvbnN0O1xyXG5leHBvcnQgY29uc3QgY2hhaW5Db2Rlc1Ayc2hQMndzaCA9IFsxMCwgMTFdIGFzIGNvbnN0O1xyXG5leHBvcnQgY29uc3QgY2hhaW5Db2Rlc1Ayd3NoID0gWzIwLCAyMV0gYXMgY29uc3Q7XHJcbmV4cG9ydCBjb25zdCBjaGFpbkNvZGVzUDJ0ciA9IFszMCwgMzFdIGFzIGNvbnN0O1xyXG5leHBvcnQgY29uc3QgY2hhaW5Db2Rlc1AydHJNdXNpZzIgPSBbNDAsIDQxXSBhcyBjb25zdDtcclxuZXhwb3J0IGNvbnN0IGNoYWluQ29kZXMgPSBbXHJcbiAgLi4uY2hhaW5Db2Rlc1Ayc2gsXHJcbiAgLi4uY2hhaW5Db2Rlc1Ayc2hQMndzaCxcclxuICAuLi5jaGFpbkNvZGVzUDJ3c2gsXHJcbiAgLi4uY2hhaW5Db2Rlc1AydHIsXHJcbiAgLi4uY2hhaW5Db2Rlc1AydHJNdXNpZzIsXHJcbl07XHJcbmV4cG9ydCB0eXBlIENoYWluQ29kZSA9ICh0eXBlb2YgY2hhaW5Db2RlcylbbnVtYmVyXTtcclxuZXhwb3J0IGZ1bmN0aW9uIGlzQ2hhaW5Db2RlKG46IHVua25vd24pOiBuIGlzIENoYWluQ29kZSB7XHJcbiAgcmV0dXJuIGNoYWluQ29kZXMuaW5jbHVkZXMobiBhcyBDaGFpbkNvZGUpO1xyXG59XHJcblxyXG4vKipcclxuICogQSBzY3JpcHQgdHlwZSBtYXBzIHRvIHR3byBDaGFpbkNvZGVzOlxyXG4gKiBFeHRlcm5hbCBhZGRyZXNzZXMgYXJlIGludGVuZGVkIGZvciBkZXBvc2l0cywgaW50ZXJuYWwgYWRkcmVzc2VzIGFyZSBpbnRlbmRlZCBmb3IgY2hhbmdlIG91dHB1dHMuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBDaGFpbkNvZGVQYWlyID0gUmVhZG9ubHk8W2V4dGVybmFsOiBDaGFpbkNvZGUsIGludGVybmFsOiBDaGFpbkNvZGVdPjtcclxuXHJcbmNvbnN0IG1hcCA9IG5ldyBNYXA8U2NyaXB0VHlwZTJPZjMsIENoYWluQ29kZVBhaXI+KFxyXG4gIFtcclxuICAgIFsncDJzaCcsIGNoYWluQ29kZXNQMnNoXSxcclxuICAgIFsncDJzaFAyd3NoJywgY2hhaW5Db2Rlc1Ayc2hQMndzaF0sXHJcbiAgICBbJ3Ayd3NoJywgY2hhaW5Db2Rlc1Ayd3NoXSxcclxuICAgIFsncDJ0cicsIGNoYWluQ29kZXNQMnRyXSxcclxuICAgIFsncDJ0ck11c2lnMicsIGNoYWluQ29kZXNQMnRyTXVzaWcyXSxcclxuICBdLm1hcCgoW2ssIHZdKSA9PiBbayBhcyBTY3JpcHRUeXBlMk9mMywgT2JqZWN0LmZyZWV6ZSh2KSBhcyBDaGFpbkNvZGVQYWlyXSlcclxuKTtcclxuXHJcbmNvbnN0IHBhaXJzID0gWy4uLm1hcC52YWx1ZXMoKV07XHJcblxyXG4vKipcclxuICogQHJldHVybiBDaGFpbkNvZGVQYWlyIGZvciBpbnB1dFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHRvQ2hhaW5QYWlyKHY6IENoYWluQ29kZVBhaXIgfCBDaGFpbkNvZGUgfCBTY3JpcHRUeXBlMk9mMyk6IENoYWluQ29kZVBhaXIge1xyXG4gIGxldCBwYWlyO1xyXG4gIGlmIChBcnJheS5pc0FycmF5KHYpKSB7XHJcbiAgICBpZiAocGFpcnMuaW5jbHVkZXModiBhcyBDaGFpbkNvZGVQYWlyKSkge1xyXG4gICAgICBwYWlyID0gdjtcclxuICAgIH1cclxuICB9XHJcbiAgaWYgKHR5cGVvZiB2ID09PSAnc3RyaW5nJykge1xyXG4gICAgcGFpciA9IG1hcC5nZXQodik7XHJcbiAgfVxyXG4gIGlmICh0eXBlb2YgdiA9PT0gJ251bWJlcicpIHtcclxuICAgIHBhaXIgPSBwYWlycy5maW5kKChwKSA9PiBwLmluY2x1ZGVzKHYpKTtcclxuICB9XHJcbiAgaWYgKCFwYWlyKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYG5vIHBhaXIgZm9yIGlucHV0ICR7dn1gKTtcclxuICB9XHJcbiAgcmV0dXJuIHBhaXIgYXMgQ2hhaW5Db2RlUGFpcjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEByZXR1cm4gU2NyaXB0VHlwZTJPZjMgZm9yIGlucHV0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2NyaXB0VHlwZUZvckNoYWluKGNoYWluOiBDaGFpbkNvZGUpOiBTY3JpcHRUeXBlMk9mMyB7XHJcbiAgZm9yIChjb25zdCBbc2NyaXB0VHlwZSwgcGFpcl0gb2YgbWFwLmVudHJpZXMoKSkge1xyXG4gICAgaWYgKHBhaXIuaW5jbHVkZXMoY2hhaW4pKSB7XHJcbiAgICAgIHJldHVybiBzY3JpcHRUeXBlO1xyXG4gICAgfVxyXG4gIH1cclxuICB0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgY2hhaW4gJHtjaGFpbn1gKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEByZXR1cm4gY2hhaW4gY29kZSBpbnRlbmRlZCBmb3IgZXh0ZXJuYWwgYWRkcmVzc2VzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXh0ZXJuYWxDaGFpbkNvZGUodjogQ2hhaW5Db2RlUGFpciB8IFNjcmlwdFR5cGUyT2YzIHwgQ2hhaW5Db2RlKTogQ2hhaW5Db2RlIHtcclxuICByZXR1cm4gdG9DaGFpblBhaXIodilbMF07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAcmV0dXJuIGNoYWluIGNvZGUgaW50ZW5kZWQgZm9yIGNoYW5nZSBvdXRwdXRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0SW50ZXJuYWxDaGFpbkNvZGUodjogQ2hhaW5Db2RlUGFpciB8IFNjcmlwdFR5cGUyT2YzIHwgQ2hhaW5Db2RlKTogQ2hhaW5Db2RlIHtcclxuICByZXR1cm4gdG9DaGFpblBhaXIodilbMV07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAcmV0dXJuIHRydWUgaWZmIGNoYWluIGNvZGUgaXMgZXh0ZXJuYWxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0V4dGVybmFsQ2hhaW5Db2RlKHY6IENoYWluQ29kZSk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiB0b0NoYWluUGFpcih2KS5pbmRleE9mKHYpID09PSAwO1xyXG59XHJcblxyXG4vKipcclxuICogQHJldHVybiB0cnVlIGlmZiBjaGFpbiBjb2RlIGlzIGludGVybmFsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNJbnRlcm5hbENoYWluQ29kZSh2OiBDaGFpbkNvZGUpOiBib29sZWFuIHtcclxuICByZXR1cm4gdG9DaGFpblBhaXIodikuaW5kZXhPZih2KSA9PT0gMTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEByZXR1cm4gdHJ1ZSBpZmYgY2hhaW4gY29kZSBpcyBhIHNlZ3dpdCBhZGRyZXNzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNTZWd3aXQodjogQ2hhaW5Db2RlKTogYm9vbGVhbiB7XHJcbiAgY29uc3Qgc2Vnd2l0Q29kZXM6IENoYWluQ29kZVtdID0gW1xyXG4gICAgLi4uY2hhaW5Db2Rlc1Ayc2hQMndzaCxcclxuICAgIC4uLmNoYWluQ29kZXNQMndzaCxcclxuICAgIC4uLmNoYWluQ29kZXNQMnRyLFxyXG4gICAgLi4uY2hhaW5Db2Rlc1AydHJNdXNpZzIsXHJcbiAgXTtcclxuICByZXR1cm4gc2Vnd2l0Q29kZXMuaW5jbHVkZXModik7XHJcbn1cclxuIl19