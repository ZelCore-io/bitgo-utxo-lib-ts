"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateParsedTaprootScriptPathTxInput = exports.validateParsedTaprootKeyPathTxInput = exports.validateParsedTaprootScriptPathPsbt = exports.validateParsedTaprootKeyPathPsbt = exports.validateFinalizedInput = exports.validateParticipantsKeyVals = exports.validatePartialSigKeyVals = exports.validateNoncesKeyVals = exports.validatePsbtP2trMusig2Output = exports.validatePsbtP2trMusig2Input = exports.getUnspents = exports.constructPsbt = exports.invalidPartialSig = exports.invalidParticipantPubKeys = exports.invalidTxHash = exports.invalidTapInputKey = exports.invalidTapOutputKey = exports.dummyPartialSig = exports.dummyPrivateKey = exports.dummyAggNonce = exports.dummyPubNonce = exports.dummyParticipantPubKeys = exports.dummyTapInternalKey = exports.dummyTapOutputKey = exports.rootWalletKeys = exports.network = void 0;
const assert = require("assert");
const bitgo_1 = require("../../../src/bitgo");
const outputScripts_1 = require("../../../src/bitgo/outputScripts");
const testutil_1 = require("../../../src/testutil");
const src_1 = require("../../../src");
const PsbtUtil_1 = require("../../../src/bitgo/PsbtUtil");
exports.network = src_1.networks.bitcoin;
const outputType = 'p2trMusig2';
const CHANGE_INDEX = 100;
const FEE = BigInt(100);
const keys = [1, 2, 3].map((v) => src_1.bip32.fromSeed(Buffer.alloc(16, `test/2/${v}`), exports.network));
exports.rootWalletKeys = new bitgo_1.RootWalletKeys([keys[0], keys[1], keys[2]]);
const dummyKey1 = exports.rootWalletKeys.deriveForChainAndIndex(50, 200);
const dummyKey2 = exports.rootWalletKeys.deriveForChainAndIndex(60, 201);
exports.dummyTapOutputKey = dummyKey1.user.publicKey.subarray(1, 33);
exports.dummyTapInternalKey = dummyKey1.bitgo.publicKey.subarray(1, 33);
exports.dummyParticipantPubKeys = [dummyKey1.user.publicKey, dummyKey1.backup.publicKey];
exports.dummyPubNonce = Buffer.concat([dummyKey2.user.publicKey, dummyKey2.bitgo.publicKey]);
exports.dummyAggNonce = Buffer.concat([dummyKey2.backup.publicKey, dummyKey2.bitgo.publicKey]);
exports.dummyPrivateKey = dummyKey2.user.privateKey;
exports.dummyPartialSig = dummyKey2.backup.privateKey;
exports.invalidTapOutputKey = Buffer.allocUnsafe(1);
exports.invalidTapInputKey = Buffer.allocUnsafe(1);
exports.invalidTxHash = Buffer.allocUnsafe(1);
exports.invalidParticipantPubKeys = [Buffer.allocUnsafe(1), Buffer.allocUnsafe(1)];
exports.invalidPartialSig = Buffer.allocUnsafe(1);
function constructPsbt(unspents, rootWalletKeys, signer, cosigner, outputs) {
    const psbt = (0, bitgo_1.createPsbtForNetwork)({ network: exports.network });
    if (Array.isArray(outputs)) {
        outputs.forEach((output) => (0, bitgo_1.addWalletOutputToPsbt)(psbt, rootWalletKeys, output.chain, output.index, output.value));
    }
    else {
        const total = BigInt((0, bitgo_1.unspentSum)(unspents, 'bigint'));
        (0, bitgo_1.addWalletOutputToPsbt)(psbt, rootWalletKeys, (0, bitgo_1.getInternalChainCode)(outputs), CHANGE_INDEX, total - FEE);
    }
    unspents.forEach((u) => {
        if ((0, bitgo_1.isWalletUnspent)(u)) {
            (0, bitgo_1.addWalletUnspentToPsbt)(psbt, u, rootWalletKeys, signer, cosigner);
        }
        else {
            const { redeemScript } = (0, outputScripts_1.createOutputScriptP2shP2pk)(testutil_1.replayProtectionKeyPair.publicKey);
            assert.ok(redeemScript);
            (0, bitgo_1.addReplayProtectionUnspentToPsbt)(psbt, u, redeemScript);
        }
    });
    return psbt;
}
exports.constructPsbt = constructPsbt;
function getUnspents(inputScriptTypes, rootWalletKeys) {
    return inputScriptTypes.map((t, i) => {
        if (!bitgo_1.outputScripts.isScriptType2Of3(t)) {
            throw new Error(`invalid input type ${t}`);
        }
        const unspent = (0, testutil_1.mockWalletUnspent)(exports.network, BigInt('10000000000000000'), {
            keys: rootWalletKeys,
            chain: (0, bitgo_1.getExternalChainCode)(t),
            vout: i,
        });
        if ((0, bitgo_1.isWalletUnspent)(unspent)) {
            return unspent;
        }
        throw new Error('Invalid unspent');
    });
}
exports.getUnspents = getUnspents;
function validatePsbtP2trMusig2Input(psbt, index, unspent, spendType) {
    var _a, _b;
    const input = psbt.data.inputs[index];
    assert.strictEqual((_a = input.tapBip32Derivation) === null || _a === void 0 ? void 0 : _a.length, 2);
    let leafHashesCount = 0;
    if (spendType === 'keyPath') {
        const inputWalletKeys = exports.rootWalletKeys.deriveForChainAndIndex(unspent.chain, unspent.index);
        const { internalPubkey, taptreeRoot } = (0, outputScripts_1.createKeyPathP2trMusig2)(inputWalletKeys.publicKeys);
        assert.ok(!input.tapLeafScript);
        assert.ok(input.tapInternalKey);
        assert.ok(input.tapMerkleRoot);
        assert.ok(input.tapInternalKey.equals(internalPubkey));
        assert.ok(input.tapMerkleRoot.equals(taptreeRoot));
    }
    else {
        assert.ok(input.tapLeafScript);
        assert.ok(!input.tapInternalKey);
        assert.ok(!input.tapMerkleRoot);
        leafHashesCount = 1;
    }
    (_b = input.tapBip32Derivation) === null || _b === void 0 ? void 0 : _b.forEach((bv) => {
        assert.strictEqual(bv.leafHashes.length, leafHashesCount);
    });
}
exports.validatePsbtP2trMusig2Input = validatePsbtP2trMusig2Input;
function validatePsbtP2trMusig2Output(psbt, index) {
    var _a, _b;
    const outputWalletKeys = exports.rootWalletKeys.deriveForChainAndIndex((0, bitgo_1.getInternalChainCode)(outputType), CHANGE_INDEX);
    const payment = (0, outputScripts_1.createPaymentP2trMusig2)(outputWalletKeys.publicKeys);
    const output = psbt.data.outputs[index];
    assert.ok(!!payment.internalPubkey);
    assert.ok(!!output.tapInternalKey);
    assert.ok(output.tapInternalKey.equals(payment.internalPubkey));
    assert.strictEqual((_a = output.tapBip32Derivation) === null || _a === void 0 ? void 0 : _a.length, 3);
    (_b = output.tapBip32Derivation) === null || _b === void 0 ? void 0 : _b.forEach((bv) => {
        const leafHashesCount = bv.pubkey.equals((0, outputScripts_1.toXOnlyPublicKey)(outputWalletKeys.backup.publicKey)) ? 2 : 1;
        assert.strictEqual(bv.leafHashes.length, leafHashesCount);
    });
}
exports.validatePsbtP2trMusig2Output = validatePsbtP2trMusig2Output;
function validateNoncesKeyVals(psbt, index, unspent) {
    const keyVals = psbt.getProprietaryKeyVals(index);
    const walletKeys = exports.rootWalletKeys.deriveForChainAndIndex(unspent.chain, unspent.index);
    const { outputPubkey } = (0, outputScripts_1.createKeyPathP2trMusig2)(walletKeys.publicKeys);
    const participantPubKeys = [walletKeys.user.publicKey, walletKeys.bitgo.publicKey];
    const nonces = keyVals.filter((kv) => kv.key.subtype === bitgo_1.ProprietaryKeySubtype.MUSIG2_PUB_NONCE);
    assert.strictEqual(nonces.length, 2);
    const nonceKeydata = participantPubKeys.map((p) => {
        const keydata = Buffer.alloc(65);
        p.copy(keydata);
        outputPubkey.copy(keydata, 33);
        return keydata;
    });
    nonces.forEach((kv) => {
        assert.strictEqual(kv.key.identifier, bitgo_1.PSBT_PROPRIETARY_IDENTIFIER);
        assert.strictEqual(kv.value.length, 66);
        assert.strictEqual(nonceKeydata.filter((kd) => kd.equals(kv.key.keydata)).length, 1);
    });
}
exports.validateNoncesKeyVals = validateNoncesKeyVals;
function validatePartialSigKeyVals(psbt, index, unspent) {
    const keyVals = psbt.getProprietaryKeyVals(index);
    const inputWalletKeys = exports.rootWalletKeys.deriveForChainAndIndex(unspent.chain, unspent.index);
    const { outputPubkey } = (0, outputScripts_1.createKeyPathP2trMusig2)(inputWalletKeys.publicKeys);
    const participantPubKeys = [inputWalletKeys.user.publicKey, inputWalletKeys.bitgo.publicKey];
    const partialSigs = keyVals.filter((kv) => kv.key.subtype === bitgo_1.ProprietaryKeySubtype.MUSIG2_PARTIAL_SIG);
    assert.strictEqual(partialSigs.length, 2);
    const partialSigKeydata = participantPubKeys.map((p) => {
        const keydata = Buffer.alloc(65);
        p.copy(keydata);
        outputPubkey.copy(keydata, 33);
        return keydata;
    });
    partialSigs.forEach((kv) => {
        assert.strictEqual(kv.key.identifier, bitgo_1.PSBT_PROPRIETARY_IDENTIFIER);
        assert.strictEqual(kv.value.length, 32);
        assert.strictEqual(partialSigKeydata.filter((kd) => kd.equals(kv.key.keydata)).length, 1);
    });
}
exports.validatePartialSigKeyVals = validatePartialSigKeyVals;
function validateParticipantsKeyVals(psbt, index, unspent) {
    const keyVals = psbt.getProprietaryKeyVals(index);
    const walletKeys = exports.rootWalletKeys.deriveForChainAndIndex(unspent.chain, unspent.index);
    const { internalPubkey, outputPubkey } = (0, outputScripts_1.createKeyPathP2trMusig2)(walletKeys.publicKeys);
    const participantPubKeys = [walletKeys.user.publicKey, walletKeys.bitgo.publicKey];
    const participantsKeyVals = keyVals.filter((kv) => kv.key.subtype === bitgo_1.ProprietaryKeySubtype.MUSIG2_PARTICIPANT_PUB_KEYS);
    assert.strictEqual(participantsKeyVals.length, 1);
    const kv = participantsKeyVals[0];
    assert.strictEqual(kv.key.identifier, bitgo_1.PSBT_PROPRIETARY_IDENTIFIER);
    assert.ok(Buffer.concat([outputPubkey, internalPubkey]).equals(kv.key.keydata));
    const valueMatch = [Buffer.concat(participantPubKeys), Buffer.concat(participantPubKeys.reverse())].some((pks) => {
        return pks.equals(kv.value);
    });
    assert.ok(valueMatch);
}
exports.validateParticipantsKeyVals = validateParticipantsKeyVals;
function validateFinalizedInput(psbt, index, unspent, spendType) {
    var _a, _b;
    const input = psbt.data.inputs[index];
    assert.ok((0, PsbtUtil_1.isPsbtInputFinalized)(input));
    if ((0, bitgo_1.scriptTypeForChain)(unspent.chain) === 'p2trMusig2' && spendType === 'keyPath') {
        assert.strictEqual((_a = input.finalScriptWitness) === null || _a === void 0 ? void 0 : _a.length, 66);
    }
    assert.ok(!((_b = input.unknownKeyVals) === null || _b === void 0 ? void 0 : _b.length));
}
exports.validateFinalizedInput = validateFinalizedInput;
function validateParsedTaprootKeyPathPsbt(psbt, index, signature) {
    var _a, _b;
    const parsed = (0, bitgo_1.parsePsbtInput)(psbt.data.inputs[0]);
    assert.ok(parsed.scriptType === 'taprootKeyPathSpend');
    assert.strictEqual(parsed.pubScript.length, 34);
    assert.strictEqual(parsed.publicKeys.length, 1);
    assert.strictEqual(parsed.publicKeys[0].length, 32);
    if (signature === 'unsigned') {
        assert.strictEqual(parsed.signatures, undefined);
        assert.strictEqual(parsed.participantPublicKeys, undefined);
    }
    else {
        const expected = signature === 'halfsigned' ? 1 : 2;
        assert.strictEqual((_a = parsed.signatures) === null || _a === void 0 ? void 0 : _a.length, expected);
        parsed.signatures.forEach((sig) => {
            assert.strictEqual(sig.length, 32);
        });
        assert.strictEqual((_b = parsed.participantPublicKeys) === null || _b === void 0 ? void 0 : _b.length, expected);
        parsed.participantPublicKeys.forEach((pk) => {
            assert.strictEqual(pk.length, 33);
        });
    }
}
exports.validateParsedTaprootKeyPathPsbt = validateParsedTaprootKeyPathPsbt;
function validateParsedTaprootScriptPathPsbt(psbt, index, signature) {
    var _a;
    const input = psbt.data.inputs[index];
    const parsed = (0, bitgo_1.parsePsbtInput)(psbt.data.inputs[0]);
    assert.ok(parsed.scriptType === 'taprootScriptPathSpend');
    assert.ok(input.tapLeafScript);
    assert.ok(parsed.pubScript.equals(input.tapLeafScript[0].script));
    assert.ok(parsed.controlBlock.equals(input.tapLeafScript[0].controlBlock));
    assert.strictEqual(parsed.scriptPathLevel, 1);
    assert.strictEqual(parsed.leafVersion, input.tapLeafScript[0].leafVersion);
    parsed.publicKeys.forEach((pk) => {
        assert.strictEqual(pk.length, 32);
    });
    if (signature === 'unsigned') {
        assert.strictEqual(parsed.signatures, undefined);
    }
    else {
        const expected = signature === 'halfsigned' ? 1 : 2;
        assert.strictEqual((_a = parsed.signatures) === null || _a === void 0 ? void 0 : _a.length, expected);
        parsed.signatures.forEach((sig) => {
            assert.strictEqual(sig.length, 64);
        });
    }
}
exports.validateParsedTaprootScriptPathPsbt = validateParsedTaprootScriptPathPsbt;
function validateParsedTaprootKeyPathTxInput(psbt, tx) {
    const parsedTxInput = (0, bitgo_1.parseSignatureScript2Of3)(tx.ins[0]);
    assert.ok(parsedTxInput.scriptType === 'taprootKeyPathSpend');
    assert.strictEqual(parsedTxInput.signatures.length, 1);
    assert.strictEqual(parsedTxInput.signatures[0].length, 64);
}
exports.validateParsedTaprootKeyPathTxInput = validateParsedTaprootKeyPathTxInput;
function validateParsedTaprootScriptPathTxInput(psbt, tx, index) {
    var _a;
    const input = psbt.data.inputs[index];
    const parsedTxInput = (0, bitgo_1.parseSignatureScript2Of3)(tx.ins[0]);
    assert.ok(parsedTxInput);
    assert.ok(parsedTxInput.scriptType === 'taprootScriptPathSpend');
    assert.ok(input.tapLeafScript);
    assert.ok(parsedTxInput.pubScript.equals(input.tapLeafScript[0].script));
    assert.ok(parsedTxInput.controlBlock.equals(input.tapLeafScript[0].controlBlock));
    assert.strictEqual(parsedTxInput.scriptPathLevel, 1);
    assert.strictEqual(parsedTxInput.leafVersion, input.tapLeafScript[0].leafVersion);
    parsedTxInput.publicKeys.forEach((pk) => {
        assert.strictEqual(pk.length, 32);
    });
    assert.strictEqual((_a = parsedTxInput.signatures) === null || _a === void 0 ? void 0 : _a.length, 2);
    parsedTxInput.signatures.forEach((sig) => {
        assert.strictEqual(sig.length, 64);
    });
}
exports.validateParsedTaprootScriptPathTxInput = validateParsedTaprootScriptPathTxInput;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTXVzaWcyVXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3QvYml0Z28vcHNidC9NdXNpZzJVdGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLGlDQUFpQztBQUVqQyw4Q0F1QjRCO0FBQzVCLG9FQU0wQztBQUMxQyxvREFBbUY7QUFDbkYsc0NBQStDO0FBRS9DLDBEQUFtRTtBQUV0RCxRQUFBLE9BQU8sR0FBRyxjQUFRLENBQUMsT0FBTyxDQUFDO0FBQ3hDLE1BQU0sVUFBVSxHQUFHLFlBQVksQ0FBQztBQUNoQyxNQUFNLFlBQVksR0FBRyxHQUFHLENBQUM7QUFDekIsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBRXhCLE1BQU0sSUFBSSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLFdBQUssQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsVUFBVSxDQUFDLEVBQUUsQ0FBQyxFQUFFLGVBQU8sQ0FBQyxDQUFxQixDQUFDO0FBQ25HLFFBQUEsY0FBYyxHQUFHLElBQUksc0JBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUU5RSxNQUFNLFNBQVMsR0FBRyxzQkFBYyxDQUFDLHNCQUFzQixDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUNqRSxNQUFNLFNBQVMsR0FBRyxzQkFBYyxDQUFDLHNCQUFzQixDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUVwRCxRQUFBLGlCQUFpQixHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFD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LENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDckQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDbEYsYUFBYSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRTtRQUN0QyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDcEMsQ0FBQyxDQUFDLENBQUM7SUFDSCxNQUFNLENBQUMsV0FBVyxDQUFDLE1BQUEsYUFBYSxDQUFDLFVBQVUsMENBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3hELGFBQWEsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUU7UUFDdkMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3JDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQXJCRCx3RkFxQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBhc3NlcnQgZnJvbSAnYXNzZXJ0JztcclxuXHJcbmltcG9ydCB7XHJcbiAgYWRkUmVwbGF5UHJvdGVjdGlvblVuc3BlbnRUb1BzYnQsXHJcbiAgYWRkV2FsbGV0T3V0cHV0VG9Qc2J0LFxyXG4gIGFkZFdhbGxldFVuc3BlbnRUb1BzYnQsXHJcbiAgY3JlYXRlUHNidEZvck5ldHdvcmssXHJcbiAgZ2V0RXh0ZXJuYWxDaGFpbkNvZGUsXHJcbiAgZ2V0SW50ZXJuYWxDaGFpbkNvZGUsXHJcbiAgaXNXYWxsZXRVbnNwZW50LFxyXG4gIEtleU5hbWUsXHJcbiAgb3V0cHV0U2NyaXB0cyxcclxuICBwYXJzZVBzYnRJbnB1dCxcclxuICBwYXJzZVNpZ25hdHVyZVNjcmlwdDJPZjMsXHJcbiAgUHJvcHJpZXRhcnlLZXlTdWJ0eXBlLFxyXG4gIFBTQlRfUFJPUFJJRVRBUllfSURFTlRJRklFUixcclxuICBSb290V2FsbGV0S2V5cyxcclxuICBzY3JpcHRUeXBlRm9yQ2hhaW4sXHJcbiAgVHVwbGUsXHJcbiAgVW5zcGVudCxcclxuICB1bnNwZW50U3VtLFxyXG4gIFV0eG9Qc2J0LFxyXG4gIFV0eG9UcmFuc2FjdGlvbixcclxuICBXYWxsZXRVbnNwZW50LFxyXG4gIENoYWluQ29kZSxcclxufSBmcm9tICcuLi8uLi8uLi9zcmMvYml0Z28nO1xyXG5pbXBvcnQge1xyXG4gIGNyZWF0ZUtleVBhdGhQMnRyTXVzaWcyLFxyXG4gIGNyZWF0ZU91dHB1dFNjcmlwdFAyc2hQMnBrLFxyXG4gIGNyZWF0ZVBheW1lbnRQMnRyTXVzaWcyLFxyXG4gIFNjcmlwdFR5cGUyT2YzLFxyXG4gIHRvWE9ubHlQdWJsaWNLZXksXHJcbn0gZnJvbSAnLi4vLi4vLi4vc3JjL2JpdGdvL291dHB1dFNjcmlwdHMnO1xyXG5pbXBvcnQgeyBtb2NrV2FsbGV0VW5zcGVudCwgcmVwbGF5UHJvdGVjdGlvbktleVBhaXIgfSBmcm9tICcuLi8uLi8uLi9zcmMvdGVzdHV0aWwnO1xyXG5pbXBvcnQgeyBiaXAzMiwgbmV0d29ya3MgfSBmcm9tICcuLi8uLi8uLi9zcmMnO1xyXG5pbXBvcnQgeyBCSVAzMkludGVyZmFjZSB9IGZyb20gJ2JpcDMyJztcclxuaW1wb3J0IHsgaXNQc2J0SW5wdXRGaW5hbGl6ZWQgfSBmcm9tICcuLi8uLi8uLi9zcmMvYml0Z28vUHNidFV0aWwnO1xyXG5cclxuZXhwb3J0IGNvbnN0IG5ldHdvcmsgPSBuZXR3b3Jrcy5iaXRjb2luO1xyXG5jb25zdCBvdXRwdXRUeXBlID0gJ3AydHJNdXNpZzInO1xyXG5jb25zdCBDSEFOR0VfSU5ERVggPSAxMDA7XHJcbmNvbnN0IEZFRSA9IEJpZ0ludCgxMDApO1xyXG5cclxuY29uc3Qga2V5cyA9IFsxLCAyLCAzXS5tYXAoKHYpID0+IGJpcDMyLmZyb21TZWVkKEJ1ZmZlci5hbGxvYygxNiwgYHRlc3QvMi8ke3Z9YCksIG5ldHdvcmspKSBhcyBCSVAzMkludGVyZmFjZVtdO1xyXG5leHBvcnQgY29uc3Qgcm9vdFdhbGxldEtleXMgPSBuZXcgUm9vdFdhbGxldEtleXMoW2tleXNbMF0sIGtleXNbMV0sIGtleXNbMl1dKTtcclxuXHJcbmNvbnN0IGR1bW15S2V5MSA9IHJvb3RXYWxsZXRLZXlzLmRlcml2ZUZvckNoYWluQW5kSW5kZXgoNTAsIDIwMCk7XHJcbmNvbnN0IGR1bW15S2V5MiA9IHJvb3RXYWxsZXRLZXlzLmRlcml2ZUZvckNoYWluQW5kSW5kZXgoNjAsIDIwMSk7XHJcblxyXG5leHBvcnQgY29uc3QgZHVtbXlUYXBPdXRwdXRLZXkgPSBkdW1teUtleTEudXNlci5wdWJsaWNLZXkuc3ViYXJyYXkoMSwgMzMpO1xyXG5leHBvcnQgY29uc3QgZHVtbXlUYXBJbnRlcm5hbEtleSA9IGR1bW15S2V5MS5iaXRnby5wdWJsaWNLZXkuc3ViYXJyYXkoMSwgMzMpO1xyXG5leHBvcnQgY29uc3QgZHVtbXlQYXJ0aWNpcGFudFB1YktleXM6IFR1cGxlPEJ1ZmZlcj4gPSBbZHVtbXlLZXkxLnVzZXIucHVibGljS2V5LCBkdW1teUtleTEuYmFja3VwLnB1YmxpY0tleV07XHJcbmV4cG9ydCBjb25zdCBkdW1teVB1Yk5vbmNlID0gQnVmZmVyLmNvbmNhdChbZHVtbXlLZXkyLnVzZXIucHVibGljS2V5LCBkdW1teUtleTIuYml0Z28ucHVibGljS2V5XSk7XHJcbmV4cG9ydCBjb25zdCBkdW1teUFnZ05vbmNlID0gQnVmZmVyLmNvbmNhdChbZHVtbXlLZXkyLmJhY2t1cC5wdWJsaWNLZXksIGR1bW15S2V5Mi5iaXRnby5wdWJsaWNLZXldKTtcclxuZXhwb3J0IGNvbnN0IGR1bW15UHJpdmF0ZUtleSA9IGR1bW15S2V5Mi51c2VyLnByaXZhdGVLZXkhO1xyXG5leHBvcnQgY29uc3QgZHVtbXlQYXJ0aWFsU2lnID0gZHVtbXlLZXkyLmJhY2t1cC5wcml2YXRlS2V5ITtcclxuXHJcbmV4cG9ydCBjb25zdCBpbnZhbGlkVGFwT3V0cHV0S2V5ID0gQnVmZmVyLmFsbG9jVW5zYWZlKDEpO1xyXG5leHBvcnQgY29uc3QgaW52YWxpZFRhcElucHV0S2V5ID0gQnVmZmVyLmFsbG9jVW5zYWZlKDEpO1xyXG5leHBvcnQgY29uc3QgaW52YWxpZFR4SGFzaCA9IEJ1ZmZlci5hbGxvY1Vuc2FmZSgxKTtcclxuZXhwb3J0IGNvbnN0IGludmFsaWRQYXJ0aWNpcGFudFB1YktleXM6IFR1cGxlPEJ1ZmZlcj4gPSBbQnVmZmVyLmFsbG9jVW5zYWZlKDEpLCBCdWZmZXIuYWxsb2NVbnNhZmUoMSldO1xyXG5leHBvcnQgY29uc3QgaW52YWxpZFBhcnRpYWxTaWcgPSBCdWZmZXIuYWxsb2NVbnNhZmUoMSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29uc3RydWN0UHNidChcclxuICB1bnNwZW50czogKFVuc3BlbnQ8YmlnaW50PiAmIHsgcHJldlR4PzogQnVmZmVyIH0pW10sXHJcbiAgcm9vdFdhbGxldEtleXM6IFJvb3RXYWxsZXRLZXlzLFxyXG4gIHNpZ25lcjogS2V5TmFtZSxcclxuICBjb3NpZ25lcjogS2V5TmFtZSxcclxuICBvdXRwdXRzOiB7IGNoYWluOiBDaGFpbkNvZGU7IGluZGV4OiBudW1iZXI7IHZhbHVlOiBiaWdpbnQgfVtdIHwgb3V0cHV0U2NyaXB0cy5TY3JpcHRUeXBlMk9mM1xyXG4pOiBVdHhvUHNidCB7XHJcbiAgY29uc3QgcHNidCA9IGNyZWF0ZVBzYnRGb3JOZXR3b3JrKHsgbmV0d29yayB9KTtcclxuXHJcbiAgaWYgKEFycmF5LmlzQXJyYXkob3V0cHV0cykpIHtcclxuICAgIG91dHB1dHMuZm9yRWFjaCgob3V0cHV0KSA9PiBhZGRXYWxsZXRPdXRwdXRUb1BzYnQocHNidCwgcm9vdFdhbGxldEtleXMsIG91dHB1dC5jaGFpbiwgb3V0cHV0LmluZGV4LCBvdXRwdXQudmFsdWUpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY29uc3QgdG90YWwgPSBCaWdJbnQodW5zcGVudFN1bTxiaWdpbnQ+KHVuc3BlbnRzLCAnYmlnaW50JykpO1xyXG4gICAgYWRkV2FsbGV0T3V0cHV0VG9Qc2J0KHBzYnQsIHJvb3RXYWxsZXRLZXlzLCBnZXRJbnRlcm5hbENoYWluQ29kZShvdXRwdXRzKSwgQ0hBTkdFX0lOREVYLCB0b3RhbCAtIEZFRSk7XHJcbiAgfVxyXG4gIHVuc3BlbnRzLmZvckVhY2goKHUpID0+IHtcclxuICAgIGlmIChpc1dhbGxldFVuc3BlbnQodSkpIHtcclxuICAgICAgYWRkV2FsbGV0VW5zcGVudFRvUHNidChwc2J0LCB1LCByb290V2FsbGV0S2V5cywgc2lnbmVyLCBjb3NpZ25lcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCB7IHJlZGVlbVNjcmlwdCB9ID0gY3JlYXRlT3V0cHV0U2NyaXB0UDJzaFAycGsocmVwbGF5UHJvdGVjdGlvbktleVBhaXIucHVibGljS2V5KTtcclxuICAgICAgYXNzZXJ0Lm9rKHJlZGVlbVNjcmlwdCk7XHJcbiAgICAgIGFkZFJlcGxheVByb3RlY3Rpb25VbnNwZW50VG9Qc2J0KHBzYnQsIHUsIHJlZGVlbVNjcmlwdCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgcmV0dXJuIHBzYnQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRVbnNwZW50cyhcclxuICBpbnB1dFNjcmlwdFR5cGVzOiBTY3JpcHRUeXBlMk9mM1tdLFxyXG4gIHJvb3RXYWxsZXRLZXlzOiBSb290V2FsbGV0S2V5c1xyXG4pOiBXYWxsZXRVbnNwZW50PGJpZ2ludD5bXSB7XHJcbiAgcmV0dXJuIGlucHV0U2NyaXB0VHlwZXMubWFwKCh0LCBpKTogV2FsbGV0VW5zcGVudDxiaWdpbnQ+ID0+IHtcclxuICAgIGlmICghb3V0cHV0U2NyaXB0cy5pc1NjcmlwdFR5cGUyT2YzKHQpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgaW52YWxpZCBpbnB1dCB0eXBlICR7dH1gKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHVuc3BlbnQgPSBtb2NrV2FsbGV0VW5zcGVudChuZXR3b3JrLCBCaWdJbnQoJzEwMDAwMDAwMDAwMDAwMDAwJyksIHtcclxuICAgICAga2V5czogcm9vdFdhbGxldEtleXMsXHJcbiAgICAgIGNoYWluOiBnZXRFeHRlcm5hbENoYWluQ29kZSh0KSxcclxuICAgICAgdm91dDogaSxcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChpc1dhbGxldFVuc3BlbnQodW5zcGVudCkpIHtcclxuICAgICAgcmV0dXJuIHVuc3BlbnQ7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdW5zcGVudCcpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQc2J0UDJ0ck11c2lnMklucHV0KFxyXG4gIHBzYnQ6IFV0eG9Qc2J0PFV0eG9UcmFuc2FjdGlvbjxiaWdpbnQ+PixcclxuICBpbmRleDogbnVtYmVyLFxyXG4gIHVuc3BlbnQ6IFdhbGxldFVuc3BlbnQ8YmlnaW50PixcclxuICBzcGVuZFR5cGU6ICdrZXlQYXRoJyB8ICdzY3JpcHRQYXRoJ1xyXG4pOiB2b2lkIHtcclxuICBjb25zdCBpbnB1dCA9IHBzYnQuZGF0YS5pbnB1dHNbaW5kZXhdO1xyXG4gIGFzc2VydC5zdHJpY3RFcXVhbChpbnB1dC50YXBCaXAzMkRlcml2YXRpb24/Lmxlbmd0aCwgMik7XHJcbiAgbGV0IGxlYWZIYXNoZXNDb3VudCA9IDA7XHJcblxyXG4gIGlmIChzcGVuZFR5cGUgPT09ICdrZXlQYXRoJykge1xyXG4gICAgY29uc3QgaW5wdXRXYWxsZXRLZXlzID0gcm9vdFdhbGxldEtleXMuZGVyaXZlRm9yQ2hhaW5BbmRJbmRleCh1bnNwZW50LmNoYWluLCB1bnNwZW50LmluZGV4KTtcclxuICAgIGNvbnN0IHsgaW50ZXJuYWxQdWJrZXksIHRhcHRyZWVSb290IH0gPSBjcmVhdGVLZXlQYXRoUDJ0ck11c2lnMihpbnB1dFdhbGxldEtleXMucHVibGljS2V5cyk7XHJcblxyXG4gICAgYXNzZXJ0Lm9rKCFpbnB1dC50YXBMZWFmU2NyaXB0KTtcclxuICAgIGFzc2VydC5vayhpbnB1dC50YXBJbnRlcm5hbEtleSk7XHJcbiAgICBhc3NlcnQub2soaW5wdXQudGFwTWVya2xlUm9vdCk7XHJcbiAgICBhc3NlcnQub2soaW5wdXQudGFwSW50ZXJuYWxLZXkuZXF1YWxzKGludGVybmFsUHVia2V5KSk7XHJcbiAgICBhc3NlcnQub2soaW5wdXQudGFwTWVya2xlUm9vdC5lcXVhbHModGFwdHJlZVJvb3QpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYXNzZXJ0Lm9rKGlucHV0LnRhcExlYWZTY3JpcHQpO1xyXG4gICAgYXNzZXJ0Lm9rKCFpbnB1dC50YXBJbnRlcm5hbEtleSk7XHJcbiAgICBhc3NlcnQub2soIWlucHV0LnRhcE1lcmtsZVJvb3QpO1xyXG4gICAgbGVhZkhhc2hlc0NvdW50ID0gMTtcclxuICB9XHJcbiAgaW5wdXQudGFwQmlwMzJEZXJpdmF0aW9uPy5mb3JFYWNoKChidikgPT4ge1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGJ2LmxlYWZIYXNoZXMubGVuZ3RoLCBsZWFmSGFzaGVzQ291bnQpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQc2J0UDJ0ck11c2lnMk91dHB1dChwc2J0OiBVdHhvUHNidDxVdHhvVHJhbnNhY3Rpb248YmlnaW50Pj4sIGluZGV4OiBudW1iZXIpOiB2b2lkIHtcclxuICBjb25zdCBvdXRwdXRXYWxsZXRLZXlzID0gcm9vdFdhbGxldEtleXMuZGVyaXZlRm9yQ2hhaW5BbmRJbmRleChnZXRJbnRlcm5hbENoYWluQ29kZShvdXRwdXRUeXBlKSwgQ0hBTkdFX0lOREVYKTtcclxuICBjb25zdCBwYXltZW50ID0gY3JlYXRlUGF5bWVudFAydHJNdXNpZzIob3V0cHV0V2FsbGV0S2V5cy5wdWJsaWNLZXlzKTtcclxuICBjb25zdCBvdXRwdXQgPSBwc2J0LmRhdGEub3V0cHV0c1tpbmRleF07XHJcbiAgYXNzZXJ0Lm9rKCEhcGF5bWVudC5pbnRlcm5hbFB1YmtleSk7XHJcbiAgYXNzZXJ0Lm9rKCEhb3V0cHV0LnRhcEludGVybmFsS2V5KTtcclxuICBhc3NlcnQub2sob3V0cHV0LnRhcEludGVybmFsS2V5LmVxdWFscyhwYXltZW50LmludGVybmFsUHVia2V5KSk7XHJcbiAgYXNzZXJ0LnN0cmljdEVxdWFsKG91dHB1dC50YXBCaXAzMkRlcml2YXRpb24/Lmxlbmd0aCwgMyk7XHJcbiAgb3V0cHV0LnRhcEJpcDMyRGVyaXZhdGlvbj8uZm9yRWFjaCgoYnYpID0+IHtcclxuICAgIGNvbnN0IGxlYWZIYXNoZXNDb3VudCA9IGJ2LnB1YmtleS5lcXVhbHModG9YT25seVB1YmxpY0tleShvdXRwdXRXYWxsZXRLZXlzLmJhY2t1cC5wdWJsaWNLZXkpKSA/IDIgOiAxO1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGJ2LmxlYWZIYXNoZXMubGVuZ3RoLCBsZWFmSGFzaGVzQ291bnQpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVOb25jZXNLZXlWYWxzKFxyXG4gIHBzYnQ6IFV0eG9Qc2J0PFV0eG9UcmFuc2FjdGlvbjxiaWdpbnQ+PixcclxuICBpbmRleDogbnVtYmVyLFxyXG4gIHVuc3BlbnQ6IFdhbGxldFVuc3BlbnQ8YmlnaW50PlxyXG4pOiB2b2lkIHtcclxuICBjb25zdCBrZXlWYWxzID0gcHNidC5nZXRQcm9wcmlldGFyeUtleVZhbHMoaW5kZXgpO1xyXG4gIGNvbnN0IHdhbGxldEtleXMgPSByb290V2FsbGV0S2V5cy5kZXJpdmVGb3JDaGFpbkFuZEluZGV4KHVuc3BlbnQuY2hhaW4sIHVuc3BlbnQuaW5kZXgpO1xyXG4gIGNvbnN0IHsgb3V0cHV0UHVia2V5IH0gPSBjcmVhdGVLZXlQYXRoUDJ0ck11c2lnMih3YWxsZXRLZXlzLnB1YmxpY0tleXMpO1xyXG4gIGNvbnN0IHBhcnRpY2lwYW50UHViS2V5cyA9IFt3YWxsZXRLZXlzLnVzZXIucHVibGljS2V5LCB3YWxsZXRLZXlzLmJpdGdvLnB1YmxpY0tleV07XHJcblxyXG4gIGNvbnN0IG5vbmNlcyA9IGtleVZhbHMuZmlsdGVyKChrdikgPT4ga3Yua2V5LnN1YnR5cGUgPT09IFByb3ByaWV0YXJ5S2V5U3VidHlwZS5NVVNJRzJfUFVCX05PTkNFKTtcclxuICBhc3NlcnQuc3RyaWN0RXF1YWwobm9uY2VzLmxlbmd0aCwgMik7XHJcblxyXG4gIGNvbnN0IG5vbmNlS2V5ZGF0YSA9IHBhcnRpY2lwYW50UHViS2V5cy5tYXAoKHApID0+IHtcclxuICAgIGNvbnN0IGtleWRhdGEgPSBCdWZmZXIuYWxsb2MoNjUpO1xyXG4gICAgcC5jb3B5KGtleWRhdGEpO1xyXG4gICAgb3V0cHV0UHVia2V5LmNvcHkoa2V5ZGF0YSwgMzMpO1xyXG4gICAgcmV0dXJuIGtleWRhdGE7XHJcbiAgfSk7XHJcblxyXG4gIG5vbmNlcy5mb3JFYWNoKChrdikgPT4ge1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGt2LmtleS5pZGVudGlmaWVyLCBQU0JUX1BST1BSSUVUQVJZX0lERU5USUZJRVIpO1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGt2LnZhbHVlLmxlbmd0aCwgNjYpO1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKG5vbmNlS2V5ZGF0YS5maWx0ZXIoKGtkKSA9PiBrZC5lcXVhbHMoa3Yua2V5LmtleWRhdGEpKS5sZW5ndGgsIDEpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQYXJ0aWFsU2lnS2V5VmFscyhcclxuICBwc2J0OiBVdHhvUHNidDxVdHhvVHJhbnNhY3Rpb248YmlnaW50Pj4sXHJcbiAgaW5kZXg6IG51bWJlcixcclxuICB1bnNwZW50OiBXYWxsZXRVbnNwZW50PGJpZ2ludD5cclxuKTogdm9pZCB7XHJcbiAgY29uc3Qga2V5VmFscyA9IHBzYnQuZ2V0UHJvcHJpZXRhcnlLZXlWYWxzKGluZGV4KTtcclxuICBjb25zdCBpbnB1dFdhbGxldEtleXMgPSByb290V2FsbGV0S2V5cy5kZXJpdmVGb3JDaGFpbkFuZEluZGV4KHVuc3BlbnQuY2hhaW4sIHVuc3BlbnQuaW5kZXgpO1xyXG4gIGNvbnN0IHsgb3V0cHV0UHVia2V5IH0gPSBjcmVhdGVLZXlQYXRoUDJ0ck11c2lnMihpbnB1dFdhbGxldEtleXMucHVibGljS2V5cyk7XHJcbiAgY29uc3QgcGFydGljaXBhbnRQdWJLZXlzID0gW2lucHV0V2FsbGV0S2V5cy51c2VyLnB1YmxpY0tleSwgaW5wdXRXYWxsZXRLZXlzLmJpdGdvLnB1YmxpY0tleV07XHJcblxyXG4gIGNvbnN0IHBhcnRpYWxTaWdzID0ga2V5VmFscy5maWx0ZXIoKGt2KSA9PiBrdi5rZXkuc3VidHlwZSA9PT0gUHJvcHJpZXRhcnlLZXlTdWJ0eXBlLk1VU0lHMl9QQVJUSUFMX1NJRyk7XHJcbiAgYXNzZXJ0LnN0cmljdEVxdWFsKHBhcnRpYWxTaWdzLmxlbmd0aCwgMik7XHJcblxyXG4gIGNvbnN0IHBhcnRpYWxTaWdLZXlkYXRhID0gcGFydGljaXBhbnRQdWJLZXlzLm1hcCgocCkgPT4ge1xyXG4gICAgY29uc3Qga2V5ZGF0YSA9IEJ1ZmZlci5hbGxvYyg2NSk7XHJcbiAgICBwLmNvcHkoa2V5ZGF0YSk7XHJcbiAgICBvdXRwdXRQdWJrZXkuY29weShrZXlkYXRhLCAzMyk7XHJcbiAgICByZXR1cm4ga2V5ZGF0YTtcclxuICB9KTtcclxuXHJcbiAgcGFydGlhbFNpZ3MuZm9yRWFjaCgoa3YpID0+IHtcclxuICAgIGFzc2VydC5zdHJpY3RFcXVhbChrdi5rZXkuaWRlbnRpZmllciwgUFNCVF9QUk9QUklFVEFSWV9JREVOVElGSUVSKTtcclxuICAgIGFzc2VydC5zdHJpY3RFcXVhbChrdi52YWx1ZS5sZW5ndGgsIDMyKTtcclxuICAgIGFzc2VydC5zdHJpY3RFcXVhbChwYXJ0aWFsU2lnS2V5ZGF0YS5maWx0ZXIoKGtkKSA9PiBrZC5lcXVhbHMoa3Yua2V5LmtleWRhdGEpKS5sZW5ndGgsIDEpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQYXJ0aWNpcGFudHNLZXlWYWxzKFxyXG4gIHBzYnQ6IFV0eG9Qc2J0PFV0eG9UcmFuc2FjdGlvbjxiaWdpbnQ+PixcclxuICBpbmRleDogbnVtYmVyLFxyXG4gIHVuc3BlbnQ6IFdhbGxldFVuc3BlbnQ8YmlnaW50PlxyXG4pOiB2b2lkIHtcclxuICBjb25zdCBrZXlWYWxzID0gcHNidC5nZXRQcm9wcmlldGFyeUtleVZhbHMoaW5kZXgpO1xyXG4gIGNvbnN0IHdhbGxldEtleXMgPSByb290V2FsbGV0S2V5cy5kZXJpdmVGb3JDaGFpbkFuZEluZGV4KHVuc3BlbnQuY2hhaW4sIHVuc3BlbnQuaW5kZXgpO1xyXG4gIGNvbnN0IHsgaW50ZXJuYWxQdWJrZXksIG91dHB1dFB1YmtleSB9ID0gY3JlYXRlS2V5UGF0aFAydHJNdXNpZzIod2FsbGV0S2V5cy5wdWJsaWNLZXlzKTtcclxuICBjb25zdCBwYXJ0aWNpcGFudFB1YktleXMgPSBbd2FsbGV0S2V5cy51c2VyLnB1YmxpY0tleSwgd2FsbGV0S2V5cy5iaXRnby5wdWJsaWNLZXldO1xyXG5cclxuICBjb25zdCBwYXJ0aWNpcGFudHNLZXlWYWxzID0ga2V5VmFscy5maWx0ZXIoXHJcbiAgICAoa3YpID0+IGt2LmtleS5zdWJ0eXBlID09PSBQcm9wcmlldGFyeUtleVN1YnR5cGUuTVVTSUcyX1BBUlRJQ0lQQU5UX1BVQl9LRVlTXHJcbiAgKTtcclxuICBhc3NlcnQuc3RyaWN0RXF1YWwocGFydGljaXBhbnRzS2V5VmFscy5sZW5ndGgsIDEpO1xyXG5cclxuICBjb25zdCBrdiA9IHBhcnRpY2lwYW50c0tleVZhbHNbMF07XHJcbiAgYXNzZXJ0LnN0cmljdEVxdWFsKGt2LmtleS5pZGVudGlmaWVyLCBQU0JUX1BST1BSSUVUQVJZX0lERU5USUZJRVIpO1xyXG4gIGFzc2VydC5vayhCdWZmZXIuY29uY2F0KFtvdXRwdXRQdWJrZXksIGludGVybmFsUHVia2V5XSkuZXF1YWxzKGt2LmtleS5rZXlkYXRhKSk7XHJcbiAgY29uc3QgdmFsdWVNYXRjaCA9IFtCdWZmZXIuY29uY2F0KHBhcnRpY2lwYW50UHViS2V5cyksIEJ1ZmZlci5jb25jYXQocGFydGljaXBhbnRQdWJLZXlzLnJldmVyc2UoKSldLnNvbWUoKHBrcykgPT4ge1xyXG4gICAgcmV0dXJuIHBrcy5lcXVhbHMoa3YudmFsdWUpO1xyXG4gIH0pO1xyXG4gIGFzc2VydC5vayh2YWx1ZU1hdGNoKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRmluYWxpemVkSW5wdXQoXHJcbiAgcHNidDogVXR4b1BzYnQ8VXR4b1RyYW5zYWN0aW9uPGJpZ2ludD4+LFxyXG4gIGluZGV4OiBudW1iZXIsXHJcbiAgdW5zcGVudDogV2FsbGV0VW5zcGVudDxiaWdpbnQ+LFxyXG4gIHNwZW5kVHlwZT86ICdrZXlQYXRoJyB8ICdzY3JpcHRQYXRoJ1xyXG4pOiB2b2lkIHtcclxuICBjb25zdCBpbnB1dCA9IHBzYnQuZGF0YS5pbnB1dHNbaW5kZXhdO1xyXG4gIGFzc2VydC5vayhpc1BzYnRJbnB1dEZpbmFsaXplZChpbnB1dCkpO1xyXG4gIGlmIChzY3JpcHRUeXBlRm9yQ2hhaW4odW5zcGVudC5jaGFpbikgPT09ICdwMnRyTXVzaWcyJyAmJiBzcGVuZFR5cGUgPT09ICdrZXlQYXRoJykge1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKGlucHV0LmZpbmFsU2NyaXB0V2l0bmVzcz8ubGVuZ3RoLCA2Nik7XHJcbiAgfVxyXG4gIGFzc2VydC5vayghaW5wdXQudW5rbm93bktleVZhbHM/Lmxlbmd0aCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnNlZFRhcHJvb3RLZXlQYXRoUHNidChcclxuICBwc2J0OiBVdHhvUHNidDxVdHhvVHJhbnNhY3Rpb248YmlnaW50Pj4sXHJcbiAgaW5kZXg6IG51bWJlcixcclxuICBzaWduYXR1cmU6ICd1bnNpZ25lZCcgfCAnaGFsZnNpZ25lZCcgfCAnZnVsbHlzaWduZWQnXHJcbik6IHZvaWQge1xyXG4gIGNvbnN0IHBhcnNlZCA9IHBhcnNlUHNidElucHV0KHBzYnQuZGF0YS5pbnB1dHNbMF0pO1xyXG4gIGFzc2VydC5vayhwYXJzZWQuc2NyaXB0VHlwZSA9PT0gJ3RhcHJvb3RLZXlQYXRoU3BlbmQnKTtcclxuICBhc3NlcnQuc3RyaWN0RXF1YWwocGFyc2VkLnB1YlNjcmlwdC5sZW5ndGgsIDM0KTtcclxuICBhc3NlcnQuc3RyaWN0RXF1YWwocGFyc2VkLnB1YmxpY0tleXMubGVuZ3RoLCAxKTtcclxuICBhc3NlcnQuc3RyaWN0RXF1YWwocGFyc2VkLnB1YmxpY0tleXNbMF0ubGVuZ3RoLCAzMik7XHJcblxyXG4gIGlmIChzaWduYXR1cmUgPT09ICd1bnNpZ25lZCcpIHtcclxuICAgIGFzc2VydC5zdHJpY3RFcXVhbChwYXJzZWQuc2lnbmF0dXJlcywgdW5kZWZpbmVkKTtcclxuICAgIGFzc2VydC5zdHJpY3RFcXVhbChwYXJzZWQucGFydGljaXBhbnRQdWJsaWNLZXlzLCB1bmRlZmluZWQpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBjb25zdCBleHBlY3RlZCA9IHNpZ25hdHVyZSA9PT0gJ2hhbGZzaWduZWQnID8gMSA6IDI7XHJcbiAgICBhc3NlcnQuc3RyaWN0RXF1YWwocGFyc2VkLnNpZ25hdHVyZXM/Lmxlbmd0aCwgZXhwZWN0ZWQpO1xyXG4gICAgcGFyc2VkLnNpZ25hdHVyZXMuZm9yRWFjaCgoc2lnKSA9PiB7XHJcbiAgICAgIGFzc2VydC5zdHJpY3RFcXVhbChzaWcubGVuZ3RoLCAzMik7XHJcbiAgICB9KTtcclxuICAgIGFzc2VydC5zdHJpY3RFcXVhbChwYXJzZWQucGFydGljaXBhbnRQdWJsaWNLZXlzPy5sZW5ndGgsIGV4cGVjdGVkKTtcclxuICAgIHBhcnNlZC5wYXJ0aWNpcGFudFB1YmxpY0tleXMuZm9yRWFjaCgocGspID0+IHtcclxuICAgICAgYXNzZXJ0LnN0cmljdEVxdWFsKHBrLmxlbmd0aCwgMzMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQYXJzZWRUYXByb290U2NyaXB0UGF0aFBzYnQoXHJcbiAgcHNidDogVXR4b1BzYnQ8VXR4b1RyYW5zYWN0aW9uPGJpZ2ludD4+LFxyXG4gIGluZGV4OiBudW1iZXIsXHJcbiAgc2lnbmF0dXJlOiAndW5zaWduZWQnIHwgJ2hhbGZzaWduZWQnIHwgJ2Z1bGx5c2lnbmVkJ1xyXG4pOiB2b2lkIHtcclxuICBjb25zdCBpbnB1dCA9IHBzYnQuZGF0YS5pbnB1dHNbaW5kZXhdO1xyXG4gIGNvbnN0IHBhcnNlZCA9IHBhcnNlUHNidElucHV0KHBzYnQuZGF0YS5pbnB1dHNbMF0pO1xyXG4gIGFzc2VydC5vayhwYXJzZWQuc2NyaXB0VHlwZSA9PT0gJ3RhcHJvb3RTY3JpcHRQYXRoU3BlbmQnKTtcclxuICBhc3NlcnQub2soaW5wdXQudGFwTGVhZlNjcmlwdCk7XHJcbiAgYXNzZXJ0Lm9rKHBhcnNlZC5wdWJTY3JpcHQuZXF1YWxzKGlucHV0LnRhcExlYWZTY3JpcHRbMF0uc2NyaXB0KSk7XHJcbiAgYXNzZXJ0Lm9rKHBhcnNlZC5jb250cm9sQmxvY2suZXF1YWxzKGlucHV0LnRhcExlYWZTY3JpcHRbMF0uY29udHJvbEJsb2NrKSk7XHJcbiAgYXNzZXJ0LnN0cmljdEVxdWFsKHBhcnNlZC5zY3JpcHRQYXRoTGV2ZWwsIDEpO1xyXG4gIGFzc2VydC5zdHJpY3RFcXVhbChwYXJzZWQubGVhZlZlcnNpb24sIGlucHV0LnRhcExlYWZTY3JpcHRbMF0ubGVhZlZlcnNpb24pO1xyXG4gIHBhcnNlZC5wdWJsaWNLZXlzLmZvckVhY2goKHBrKSA9PiB7XHJcbiAgICBhc3NlcnQuc3RyaWN0RXF1YWwocGsubGVuZ3RoLCAzMik7XHJcbiAgfSk7XHJcbiAgaWYgKHNpZ25hdHVyZSA9PT0gJ3Vuc2lnbmVkJykge1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKHBhcnNlZC5zaWduYXR1cmVzLCB1bmRlZmluZWQpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBjb25zdCBleHBlY3RlZCA9IHNpZ25hdHVyZSA9PT0gJ2hhbGZzaWduZWQnID8gMSA6IDI7XHJcbiAgICBhc3NlcnQuc3RyaWN0RXF1YWwocGFyc2VkLnNpZ25hdHVyZXM/Lmxlbmd0aCwgZXhwZWN0ZWQpO1xyXG4gICAgcGFyc2VkLnNpZ25hdHVyZXMuZm9yRWFjaCgoc2lnKSA9PiB7XHJcbiAgICAgIGFzc2VydC5zdHJpY3RFcXVhbChzaWcubGVuZ3RoLCA2NCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhcnNlZFRhcHJvb3RLZXlQYXRoVHhJbnB1dChcclxuICBwc2J0OiBVdHhvUHNidDxVdHhvVHJhbnNhY3Rpb248YmlnaW50Pj4sXHJcbiAgdHg6IFV0eG9UcmFuc2FjdGlvbjxiaWdpbnQ+XHJcbik6IHZvaWQge1xyXG4gIGNvbnN0IHBhcnNlZFR4SW5wdXQgPSBwYXJzZVNpZ25hdHVyZVNjcmlwdDJPZjModHguaW5zWzBdKTtcclxuICBhc3NlcnQub2socGFyc2VkVHhJbnB1dC5zY3JpcHRUeXBlID09PSAndGFwcm9vdEtleVBhdGhTcGVuZCcpO1xyXG4gIGFzc2VydC5zdHJpY3RFcXVhbChwYXJzZWRUeElucHV0LnNpZ25hdHVyZXMubGVuZ3RoLCAxKTtcclxuICBhc3NlcnQuc3RyaWN0RXF1YWwocGFyc2VkVHhJbnB1dC5zaWduYXR1cmVzWzBdLmxlbmd0aCwgNjQpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQYXJzZWRUYXByb290U2NyaXB0UGF0aFR4SW5wdXQoXHJcbiAgcHNidDogVXR4b1BzYnQ8VXR4b1RyYW5zYWN0aW9uPGJpZ2ludD4+LFxyXG4gIHR4OiBVdHhvVHJhbnNhY3Rpb248YmlnaW50PixcclxuICBpbmRleDogbnVtYmVyXHJcbik6IHZvaWQge1xyXG4gIGNvbnN0IGlucHV0ID0gcHNidC5kYXRhLmlucHV0c1tpbmRleF07XHJcbiAgY29uc3QgcGFyc2VkVHhJbnB1dCA9IHBhcnNlU2lnbmF0dXJlU2NyaXB0Mk9mMyh0eC5pbnNbMF0pO1xyXG4gIGFzc2VydC5vayhwYXJzZWRUeElucHV0KTtcclxuICBhc3NlcnQub2socGFyc2VkVHhJbnB1dC5zY3JpcHRUeXBlID09PSAndGFwcm9vdFNjcmlwdFBhdGhTcGVuZCcpO1xyXG4gIGFzc2VydC5vayhpbnB1dC50YXBMZWFmU2NyaXB0KTtcclxuICBhc3NlcnQub2socGFyc2VkVHhJbnB1dC5wdWJTY3JpcHQuZXF1YWxzKGlucHV0LnRhcExlYWZTY3JpcHRbMF0uc2NyaXB0KSk7XHJcbiAgYXNzZXJ0Lm9rKHBhcnNlZFR4SW5wdXQuY29udHJvbEJsb2NrLmVxdWFscyhpbnB1dC50YXBMZWFmU2NyaXB0WzBdLmNvbnRyb2xCbG9jaykpO1xyXG4gIGFzc2VydC5zdHJpY3RFcXVhbChwYXJzZWRUeElucHV0LnNjcmlwdFBhdGhMZXZlbCwgMSk7XHJcbiAgYXNzZXJ0LnN0cmljdEVxdWFsKHBhcnNlZFR4SW5wdXQubGVhZlZlcnNpb24sIGlucHV0LnRhcExlYWZTY3JpcHRbMF0ubGVhZlZlcnNpb24pO1xyXG4gIHBhcnNlZFR4SW5wdXQucHVibGljS2V5cy5mb3JFYWNoKChwaykgPT4ge1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKHBrLmxlbmd0aCwgMzIpO1xyXG4gIH0pO1xyXG4gIGFzc2VydC5zdHJpY3RFcXVhbChwYXJzZWRUeElucHV0LnNpZ25hdHVyZXM/Lmxlbmd0aCwgMik7XHJcbiAgcGFyc2VkVHhJbnB1dC5zaWduYXR1cmVzLmZvckVhY2goKHNpZykgPT4ge1xyXG4gICAgYXNzZXJ0LnN0cmljdEVxdWFsKHNpZy5sZW5ndGgsIDY0KTtcclxuICB9KTtcclxufVxyXG4iXX0=